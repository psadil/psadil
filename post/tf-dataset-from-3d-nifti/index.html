<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.2.0 for Hugo"><meta name=author content="Patrick Sadil"><meta name=description content="How to store a NifTi as a TFRecord Patrick Sadil 2022-04-23
A recent project required sending brain images to TensorFlow. Unfortunately, the data exceeded memory and so during training would need to be read from the disk. Poking around the TF documentation, it seems like a recommended way to do this is to store the images as a TFRecord. The steps for doing that are collected in this gist1.
There are five main steps"><link rel=alternate hreflang=en-us href=https://psadil.github.io/psadil/post/tf-dataset-from-3d-nifti/><link rel=preconnect href=https://fonts.gstatic.com crossorigin><meta name=theme-color content="#1565c0"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/atom-one-dark.min.css crossorigin=anonymous title=hl-light media=print onload="this.media='all'"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/atom-one-dark.min.css crossorigin=anonymous title=hl-dark media=print onload="this.media='all'" disabled><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:ital,wght@0,400;0,700;1,400;1,700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:ital,wght@0,400;0,700;1,400;1,700&display=swap" media=print onload="this.media='all'"><link rel=stylesheet href=/psadil/css/wowchemy.8bc78ecea639e288ab749bc0faab617c.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-SP0TP763NP"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}function trackOutboundLink(a,b){gtag('event','click',{event_category:'outbound',event_label:a,transport_type:'beacon',event_callback:function(){b!=='_blank'&&(document.location=a)}}),console.debug("Outbound link clicked: "+a)}function onClickCallback(a){if(a.target.tagName!=='A'||a.target.host===window.location.host)return;trackOutboundLink(a.target,a.target.getAttribute('target'))}gtag('js',new Date),gtag('config','G-SP0TP763NP',{}),gtag('set',{cookie_flags:'SameSite=None;Secure'}),document.addEventListener('click',onClickCallback,!1)</script><link rel=manifest href=/psadil/index.webmanifest><link rel=icon type=image/png href=/psadil/media/icon_hu3896c2ce465988ba1fc8077f9a6388c6_268630_32x32_fill_lanczos_center_2.png><link rel=apple-touch-icon type=image/png href=/psadil/media/icon_hu3896c2ce465988ba1fc8077f9a6388c6_268630_180x180_fill_lanczos_center_2.png><link rel=canonical href=https://psadil.github.io/psadil/post/tf-dataset-from-3d-nifti/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@psadil"><meta property="twitter:creator" content="@psadil"><meta property="og:site_name" content="psadil"><meta property="og:url" content="https://psadil.github.io/psadil/post/tf-dataset-from-3d-nifti/"><meta property="og:title" content="How to store a NifTi as a TFRecord | psadil"><meta property="og:description" content="How to store a NifTi as a TFRecord Patrick Sadil 2022-04-23
A recent project required sending brain images to TensorFlow. Unfortunately, the data exceeded memory and so during training would need to be read from the disk. Poking around the TF documentation, it seems like a recommended way to do this is to store the images as a TFRecord. The steps for doing that are collected in this gist1.
There are five main steps"><meta property="og:image" content="https://psadil.github.io/psadil/post/tf-dataset-from-3d-nifti/featured.png"><meta property="twitter:image" content="https://psadil.github.io/psadil/post/tf-dataset-from-3d-nifti/featured.png"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2022-04-23T00:00:00+00:00"><meta property="article:modified_time" content="2022-06-29T08:34:09-04:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://psadil.github.io/psadil/post/tf-dataset-from-3d-nifti/"},"headline":"How to store a NifTi as a TFRecord","image":["https://psadil.github.io/psadil/post/tf-dataset-from-3d-nifti/featured.png"],"datePublished":"2022-04-23T00:00:00Z","dateModified":"2022-06-29T08:34:09-04:00","author":{"@type":"Person","name":"Patrick Sadil"},"publisher":{"@type":"Organization","name":"psadil","logo":{"@type":"ImageObject","url":"https://psadil.github.io/psadil/media/icon_hu3896c2ce465988ba1fc8077f9a6388c6_268630_192x192_fill_lanczos_center_2.png"}},"description":"How to store a NifTi as a TFRecord Patrick Sadil 2022-04-23\nA recent project required sending brain images to TensorFlow. Unfortunately, the data exceeded memory and so during training would need to be read from the disk. Poking around the TF documentation, it seems like a recommended way to do this is to store the images as a TFRecord. The steps for doing that are collected in this gist1.\nThere are five main steps"}</script><title>How to store a NifTi as a TFRecord | psadil</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=0303d0fb97f703386e177becbd2c43f6><script src=/psadil/js/wowchemy-init.min.b8153d4570dcbb34350a2a846dba8c03.js></script><div class=page-header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/psadil/>psadil</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/psadil/>psadil</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/psadil/publication><span>Publications</span></a></li><li class=nav-item><a class="nav-link active" href=/psadil/post><span>Blog</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class="nav-item dropdown theme-dropdown"><a href=# class=nav-link data-toggle=dropdown aria-haspopup=true aria-label="Display preferences"><i class="fas fa-moon" aria-hidden=true></i></a><div class=dropdown-menu><a href=# class="dropdown-item js-set-theme-light"><span>Light</span></a>
<a href=# class="dropdown-item js-set-theme-dark"><span>Dark</span></a>
<a href=# class="dropdown-item js-set-theme-auto"><span>Automatic</span></a></div></li></ul></div></nav></div><div class=page-body><article class=article><div class="article-container pt-3"><h1>How to store a NifTi as a TFRecord</h1><div class=article-metadata><span class=article-date>Last updated on
Jun 29, 2022</span>
<span class=middot-divider></span><span class=article-reading-time>6 min read</span>
<span class=middot-divider></span><span class=article-categories><i class="fas fa-folder mr-1"></i><a href=/psadil/category/gist/>gist</a></span></div></div><div class="article-header article-container featured-image-wrapper mt-4 mb-4" style=max-width:720px;max-height:720px><div style=position:relative><img src=/psadil/post/tf-dataset-from-3d-nifti/featured_hue257dd0df58a196a4449e4d941629813_2769378_720x0_resize_lanczos_2.png alt class=featured-image></div></div><div class=article-container><div class=article-style><h1 id=how-to-store-a-nifti-as-a-tfrecord>How to store a NifTi as a TFRecord</h1><p>Patrick Sadil
2022-04-23</p><p>A recent project required sending brain images to TensorFlow.
Unfortunately, the data exceeded memory and so during training would
need to be read from the disk. Poking around the TF documentation, it
seems like a recommended way to do this is to store the images as a
<a href=https://www.tensorflow.org/tutorials/load_data/tfrecord target=_blank rel=noopener>TFRecord</a>. The
steps for doing that are collected in this gist<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.</p><p>There are five main steps</p><ol><li>load the images as numpy array,</li><li>perform an preprocessing (e.g., resizing, masking),</li><li>serialize the preprocessed images and store with their labels (all
in memory) as a
<a href=https://www.tensorflow.org/api_docs/python/tf/train/Example target=_blank rel=noopener><code>tf.train.Example</code></a>,</li><li>store (on disk) the examples as
<a href=https://www.tensorflow.org/tutorials/load_data/tfrecord target=_blank rel=noopener>TFRecord</a>,
and finally</li><li>create a
<a href=https://www.tensorflow.org/api_docs/python/tf/data/Dataset target=_blank rel=noopener><code>tf.Data.Dataset</code></a>
pipeline that serves the examples to the model.</li></ol><pre><code class=language-python>import math
from numbers import Number
import numpy as np
import tensorflow as tf
import nibabel as nb
from nilearn import plotting

from typing import List
import numpy.typing as npt
</code></pre><h2 id=preprocess>Preprocess</h2><p>A full implementation might involve several preprocessing steps (e.g.,
registration, masking, cropping), but in this gist we&rsquo;ll just rescale
the images to have intensity values that range from 0-1.</p><pre><code class=language-python>def to_numpy(img: nb.Nifti1Image) -&gt; np.ndarray:
    return np.asanyarray(img.dataobj)

def load_and_preprocess(img: str) -&gt; np.ndarray:
    # convert to numpy array and preprocess
    nii = to_numpy(nb.load(img))
    # rescale to 0-1
    preprocessed = (nii - nii.min())/(nii.max() - nii.min()).astype(np.float32)
    return preprocessed
</code></pre><p>Since this method of storing data was new for me, I wanted to ensure
that I didn&rsquo;t mess up the data. For that, I mainly relied on a basic
plot of the images.</p><pre><code class=language-python>def plot_array(img: np.ndarray) -&gt; None:
    nii = nb.Nifti1Image(img, affine=np.eye(4)*2)
    plotting.plot_anat(nii)
</code></pre><p>This first step is standard neuroimaging, but just to check that the
functions are working preprocess an example brain and see how it looks.</p><pre><code class=language-python># example images packaged with fsl, found at $FSLDIR/data/standard
img = ['MNI152lin_T1_2mm.nii.gz']
preprocesed = load_and_preprocess(img[0])
plot_array(preprocesed)
</code></pre><p><img src=index.en_files/figure-gfm/cell-5-output-1.png width=653 height=269></p><p>Great! That looks like a brain. I&rsquo;ll use it as a reference to ensure
that the roundtrip processing, serializing and unserializing, returns
the arrays we need.</p><h2 id=serialize>Serialize</h2><p>Here&rsquo;s where TensorFlow starts. As those that came before have always
done, <a href=https://www.tensorflow.org/tutorials/load_data/tfrecord target=_blank rel=noopener>we&rsquo;ll rely on these
incantations</a>.</p><pre><code class=language-python>def _bytes_feature(value: bytes):
    &quot;&quot;&quot;
    Returns a bytes_list from a string / byte.

    Example:
          _bytes_feature(b'\x00')
          _bytes_feature(b'a')
    &quot;&quot;&quot;
    return tf.train.Feature(bytes_list=tf.train.BytesList(value=[value]))

def _float_feature(value: Number):
    &quot;&quot;&quot;
    Returns a float_list from a float / double.
    
        Example:
          _float_feature(2)
          _float_feature(2.)
    &quot;&quot;&quot;
    return tf.train.Feature(float_list=tf.train.FloatList(value=[value]))
</code></pre><p>Those functions seem to help ensure that the serialized data ends up
with appropriate types. But the full steps involve serializing both the
image and the label together.</p><pre><code class=language-python>def serialize_example(img: str, label: Number):
  
    # convert to numpy array and preprocess
    preprocessed = load_and_preprocess(img)

    # Notice how the numpy array is converted into a byte_string. That's serialization in memory!
    feature = {
        'label': _float_feature(label),
        'image_raw': _bytes_feature(tf.io.serialize_tensor(preprocessed).numpy())
    }

    return tf.train.Example(features=tf.train.Features(feature=feature))
</code></pre><p>To get the image back out, we need two more functions: one to
unpack/parse the example (<code>decode_example</code>) and another to
unserialize/parse (<code>parse_1_example</code>) the unpacked example.</p><pre><code class=language-python>def decode_example(record_bytes) -&gt; dict:
    example = tf.io.parse_example(
        record_bytes,     
        features = {
          &quot;label&quot;: tf.io.FixedLenFeature([], dtype=tf.float32),
          'image_raw': tf.io.FixedLenFeature([], dtype=tf.string)
          }
    )
    return example

def parse_1_example(example):
    &quot;&quot;&quot; 
    Note that the network I was using worked with 3D images, and so the batches of data were of shape `(batch_size, x_dim, y_dim, z_dim, 1)`, rather than what is typical for 2d images: `(batch_size, x_dim, y_dim, n_channels)`. 
    &quot;&quot;&quot;
    X = tf.io.parse_tensor(example['image_raw'], out_type=tf.float32)

    # the images output by tf.io.parse_tensor will have shape (x_dim, y_dim, z_dim), which is to say that they're missing the channels dimension. expand_dims is used to indicate channel (i.e., be explicit about grayscale)
    return tf.expand_dims(X, 3), example['label'] 
</code></pre><p>At this point, we have functions for preprocessing the images,
serializing them<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>, and packing each of them along with their labels
into a
<a href=https://www.tensorflow.org/api_docs/python/tf/train/Example target=_blank rel=noopener><code>tf.train.Example</code></a>.
This is all for converting the data into a format that can then be more
easily written to and read from the disk.</p><h2 id=write-serialized-examples-as-tfrecords>Write serialized examples as TFRecords</h2><p>So far, everything has been in memory. Next comes a function that
performs the above steps sequentially on several examples, and along the
way writes the examples as a
<a href=https://www.tensorflow.org/tutorials/load_data/tfrecord target=_blank rel=noopener><code>TFRecord</code></a>.<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup></p><pre><code class=language-python>def write_records(niis: List[str], labels: npt.ArrayLike, n_per_record: int, outfile: str) -&gt; None:
    &quot;&quot;&quot;
    store list of niftis (and associated label) into tfrecords for use as dataset

    Args:
        niis: files that will be preprocessed and stored in record
        labels: true label associated with each element in niis. these are the &quot;y&quot;
        n_per_record: number of examples to store in each record. TF documentation advises that the files are +100Mb. Around 400 images cropped images at 2mm resolution seems to work.
        outfile: base prefix to use when writing the records

    Returns:
        Nothing, but the records will be written to disk. 

    &quot;&quot;&quot;
    n_niis = len(niis)
    n_records = math.ceil(len(niis) / n_per_record)

    for i, shard in enumerate(range(0, n_niis, n_per_record)):
        print(f&quot;writing record {i} of {n_records-1}&quot;)
        with tf.io.TFRecordWriter(
                f&quot;{outfile}_{i:0&gt;3}-of-{n_records-1:0&gt;3}.tfrecords&quot;, 
                options= tf.io.TFRecordOptions(compression_type=&quot;GZIP&quot;)
        ) as writer:
            for nii, label in zip(niis[shard:shard+n_per_record], labels[shard:shard+n_per_record]):
                example = serialize_example(img=nii, label=label)
                writer.write(example.SerializeToString())
</code></pre><h2 id=create-dataset>Create Dataset</h2><p>For this gist, let&rsquo;s store several copies of the MNI 2mm brain.</p><pre><code class=language-python># (e.g., put nifti of label MNI152_T1_1mm_brain.nii.gz in the working directory)
n_imgs = 3
mni_nii = ['MNI152lin_T1_2mm.nii.gz'] * n_imgs

# store examples in each tfrecord. number of examples per record is configurable.
# aim for as many examples as produces files of size &gt; 100M 
prefix = &quot;tmp&quot;
write_records(mni_nii, np.arange(n_imgs), n_imgs, prefix)
</code></pre><pre><code>writing record 0 of 0

2022-05-13 15:00:56.962382: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
</code></pre><p>Calling the above will write a TFRecord file to disk. To read that
record, define a pipeline that will create a <code>tf.Data.dataset</code>.</p><pre><code class=language-python>def get_batched_dataset(files, batch_size: int = 32) -&gt; tf.data.Dataset:
    # Note: an actual pipeline would probably include at least the shuffle and prefetch methods
    dataset = (
        tf.data.Dataset.list_files(files) # note shuffling is on by default, changes order when there are multiple records
        .flat_map(lambda x: tf.data.TFRecordDataset(x, compression_type=&quot;GZIP&quot;))
        .map(decode_example)
        .map(parse_1_example)
        .batch(batch_size)
    )
    return dataset
</code></pre><p>Now, use that function to read the records back.</p><pre><code class=language-python># a full dataset will have a list with many records
list_of_records=[f'{prefix}*.tfrecords']
ds = get_batched_dataset(list_of_records, batch_size=2)
</code></pre><p>That dataset, <code>ds</code>, was our goal in the gist. It can be passed to
methods of the <code>tf.keras.Model</code>, including
[<code>tf.keras.Model.fit()</code>(<a href=https://www.tensorflow.org/api_docs/python/tf/keras/Model#fit>https://www.tensorflow.org/api_docs/python/tf/keras/Model#fit</a>)],
serving up more data than can fit in memory.</p><p>But first, the serialization is a lot, so it is a good idea to verify
that the images look okay when loaded. To do so, pluck a single example
from the dataset.</p><pre><code class=language-python>(Xs, Ys) = next(ds.as_numpy_iterator())
</code></pre><p>The dimensions of the labels are relatively easy. It&rsquo;s a 1d array with
as many elements as are in the batch.</p><pre><code class=language-python># (batch_size, )
Ys.shape
</code></pre><pre><code>(2,)
</code></pre><p>The order will depend on what shuffling is embedded in the dataset
pipeline. In this case, there was no shuffling and so we should expect
that the order is preserved.</p><pre><code class=language-python>Ys
</code></pre><pre><code>array([0., 1.], dtype=float32)
</code></pre><p>The data, <code>Xs</code>, also has a predictable shape.</p><pre><code class=language-python># (batch_size, x_dim, y_dim, z_dim, 1)
Xs.shape
</code></pre><pre><code>(2, 91, 109, 91, 1)
</code></pre><p>Take that first element in the batch and plot.</p><pre><code class=language-python>parsed_img = np.squeeze(Xs[0,])
plot_array(parsed_img)
</code></pre><p><img src=index.en_files/figure-gfm/cell-17-output-1.png width=653 height=269></p><p>That looks great! Just in case, let&rsquo;s check more explicitly</p><pre><code class=language-python>np.array_equal(preprocesed, parsed_img)
</code></pre><pre><code>True
</code></pre><p>Yay! done</p><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>Inspiration for writing came from responding to <a href=https://neurostars.org/t/tensorflow-issue-when-trying-to-use-nibabel-in-dataset/22410/2 target=_blank rel=noopener>this question on
NeuroStars</a>,
and also from an urge to try a python-based post.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>This serializing stuff is spooky black magic. I&rsquo;m going to skip
over those details and instead leave this reference, a journey
through serializing in <code>R</code>
<a href=https://blog.djnavarro.net/posts/2021-11-15_serialisation-with-rds/>https://blog.djnavarro.net/posts/2021-11-15_serialisation-with-rds/</a>.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p>It seems to me that this storage on disk involves a <em>second</em>
serialization step (where the first was done by
<code>tf.io.serialize_tensor</code> in <code>serialize_example</code>). Even so, I assume
the roundtrip isn&rsquo;t so much of a big deal, considering that the data
can be served to the model in parallel.&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div><p class=edit-page><a href=https://github.com/psadil/psadil/blob/main/content/post/2022-04-23-tf-dataset-from-3d-nifti/index.en.md>View Page Source</a></p><div class=article-tags><a class="badge badge-light" href=/psadil/tag/python/>python</a>
<a class="badge badge-light" href=/psadil/tag/mri/>mri</a></div><div class=share-box aria-hidden=true><ul class=share><li><a href="https://twitter.com/intent/tweet?url=https://psadil.github.io/psadil/post/tf-dataset-from-3d-nifti/&text=How%20to%20store%20a%20NifTi%20as%20a%20TFRecord" target=_blank rel=noopener class=share-btn-twitter><i class="fab fa-twitter"></i></a></li><li><a href="https://www.facebook.com/sharer.php?u=https://psadil.github.io/psadil/post/tf-dataset-from-3d-nifti/&t=How%20to%20store%20a%20NifTi%20as%20a%20TFRecord" target=_blank rel=noopener class=share-btn-facebook><i class="fab fa-facebook"></i></a></li><li><a href="mailto:?subject=How%20to%20store%20a%20NifTi%20as%20a%20TFRecord&body=https://psadil.github.io/psadil/post/tf-dataset-from-3d-nifti/" target=_blank rel=noopener class=share-btn-email><i class="fas fa-envelope"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?url=https://psadil.github.io/psadil/post/tf-dataset-from-3d-nifti/&title=How%20to%20store%20a%20NifTi%20as%20a%20TFRecord" target=_blank rel=noopener class=share-btn-linkedin><i class="fab fa-linkedin-in"></i></a></li><li><a href="whatsapp://send?text=How%20to%20store%20a%20NifTi%20as%20a%20TFRecord%20https://psadil.github.io/psadil/post/tf-dataset-from-3d-nifti/" target=_blank rel=noopener class=share-btn-whatsapp><i class="fab fa-whatsapp"></i></a></li><li><a href="https://service.weibo.com/share/share.php?url=https://psadil.github.io/psadil/post/tf-dataset-from-3d-nifti/&title=How%20to%20store%20a%20NifTi%20as%20a%20TFRecord" target=_blank rel=noopener class=share-btn-weibo><i class="fab fa-weibo"></i></a></li></ul></div><div class="media author-card content-widget-hr"><a href=https://psadil.github.io/psadil/><img class="avatar mr-3 avatar-circle" src="https://s.gravatar.com/avatar/6e7d3d145f872ee736e7714ceb8265c6?s=200" alt="Patrick Sadil"></a><div class=media-body><h5 class=card-title><a href=https://psadil.github.io/psadil/>Patrick Sadil</a></h5><h6 class=card-subtitle>Post-Doctoral Researcher</h6><ul class=network-icon aria-hidden=true><li><a href=mailto:psadil1@jh.edu><i class="fas fa-envelope"></i></a></li><li><a href=https://psadil.github.io/cv/cv.pdf target=_blank rel=noopener><i class="ai ai-cv"></i></a></li><li><a href=//orcid.org/0000-0003-4141-1343><i class="ai ai-orcid"></i></a></li><li><a href="https://scholar.google.co.uk/citations?user=HhPeElcAAAAJ" target=_blank rel=noopener><i class="ai ai-google-scholar"></i></a></li><li><a href=https://github.com/psadil target=_blank rel=noopener><i class="fab fa-github"></i></a></li></ul></div></div></div></article></div><div class=page-footer><div class=container><footer class=site-footer><p class=powered-by><a href=/psadil/privacy/>Privacy Policy</a>
&#183;
<a href=/psadil/terms/>Terms</a></p><p class=powered-by>© 2021 Patrick Sadil</p><p class=powered-by>Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a> — the free, <a href=https://github.com/wowchemy/wowchemy-hugo-modules target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></div><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code class="tex hljs"></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/matlab.min.js></script><script src=/psadil/js/bootstrap.bundle.min.6aed84840afc03ab4d5750157f69c120.js></script><script src=/psadil/en/js/wowchemy.min.c7dbcd0a03997d954a216caf59fc7681.js></script></body></html>